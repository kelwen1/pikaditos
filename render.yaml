services:
  - type: web
    name: mi-proyecto-laravel
    env: php
    plan: free
    # Comando para instalar dependencias de PHP y generar assets
    buildCommand: composer install --no-dev && npm install && npm run build
    # Comando para iniciar el servidor (Render usa Apache por defecto para PHP)
    startCommand: php artisan migrate --force && apachectl -D FOREGROUND
    envVars:
      - key: APP_ENV
        value: production
      - key: APP_DEBUG
        value: false
      - key: APP_KEY
        # Nota: Genera una llave y ponla aquí o en el Dashboard de Render
        sync: false 
      - key: LOG_CHANNEL
        value: stderr
      - key: DB_CONNECTION
        value: pgsql
      - key: NODE_VERSION
        value: 18.0.0
      - key: PHP_VERSION
        value: 8.2 # Ajusta según la versión que necesites

# Opcional: Si quieres que Render también cree la base de datos automáticamente
databases:
  - name: laravel_db
    plan: free
    databaseName: laravel_production
    user: admin